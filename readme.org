#+TITLE: Nixfiles

An attempt to nix all my configurations using [[https://github.com/hercules-ci/flake-parts][flake-parts]].

** File structure
- ~flakeModules~: Parts to make a whole flake.nix
- ~config~: My configurations
- ~hosts~: My ~nixosConfigurations~
- ~modules~: Reusable NixOS modules
- ~hmModules~: Reusable Home-Manager modules
- ~packages~: Packages packaged by myself and overlays

** Issues
*** Nix-doom-emacs
- Any embark commands trigger a warning and silently fail: ='embark-define-keymap' has been deprecated in Embark 0.21=
- ~user-emacs-directory~ set to ~$HOME/.cache/doom~
  - ~docs~ should be copied from ~doomemacs~ repo to ~$HOME/.cache/doom/docs~
  - ~modules~ should be copied from ~doomemacs~ repo to ~$HOME/.cache/doom/modules~
*** WSL
- Although ~services.xserver.desktopManager.runXdgAutostartIfNone~ generates a systemd target that runs xdg autostart applications,
  it is not easy to make WSL start these user services on startup (boot.command only works for root services)
- Desktop entries generated by user programs are not populated to ~/usr/share/applications~. Do it manually:
  #+begin_example
sudo rsync -ar --delete /home/atriw/.nix-profile/share/applications/. /usr/share/applications
sudo rsync -ar --delete /home/atriw/.nix-profile/share/icons/. /usr/share/icons
  #+end_example
